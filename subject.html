<!doctype html> <html> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width,initial-scale=1" /> <title>Select Level</title> <style> body { font-family: system-ui, sans-serif; margin: 0; padding: 40px; background: #f7f7f7; } .card { max-width: 520px; margin: auto; background: white; padding: 30px; border-radius: 16px; box-shadow: 0 8px 24px rgba(0,0,0,0.08); } h1 { margin-top: 0; text-align: center; } .year { display: block; padding: 14px; margin: 10px 0; border-radius: 10px; background: #0b2a6f; color: white; text-align: center; text-decoration: none; font-size: 16px; } .year:hover { background: #081f54; } .error { margin-top: 20px; padding: 14px; background: #ffe3e3; color: #7a0000; border-radius: 10px; text-align: center; } </style> </head> <body> <div class="card"> <h1>Select Level</h1> <div id="years"></div> <div id="error"></div> </div> <script> const WORKER_BASE = "https://frosty-rain-828e.futureperfectlessons.workers.dev"; const params = new URLSearchParams(location.search); const subject = params.get("subject") || "maths"; /* ------------------------- Label conversion ------------------------- */ function bucketLabel(code) { if (!code) return code; if (/^Y(\d)M$/.test(code)) { const y = code.match(/^Y(\d)M$/)[1]; return `Year ${y} Maths`; } if (/^Y(\d)M11plus$/.test(code)) { const y = code.match(/^Y(\d)M11plus$/)[1]; return `Year ${y} 11+ Maths`; } if (/^Y(\d)VR$/.test(code)) { const y = code.match(/^Y(\d)VR$/)[1]; return `Year ${y} Verbal Reasoning`; } if (/^Y(\d)MAssT(\d)$/.test(code)) { const m = code.match(/^Y(\d)MAssT(\d)$/); return `Year ${m[1]} Maths Assessment ${m[2]}`; } if (code === "VR_HOWTO") { return "How to do VR"; } return code; } /* ------------------------- Load years from worker ------------------------- */ async function loadYears() { const errorEl = document.getElementById("error"); try { const res = await fetch( `${WORKER_BASE}/years?subject=${subject}`, { credentials: "include" } ); if (!res.ok) { throw new Error("Not authorised or failed to load."); } const buckets = await res.json(); const container = document.getElementById("years"); if (!buckets.length) { container.innerHTML = "<p>No levels available.</p>"; return; } buckets.forEach(code => { const label = bucketLabel(code); const a = document.createElement("a"); a.className = "year"; a.href = `lessons.html?subject=${subject}&bucket=${code}`; a.textContent = label; container.appendChild(a); }); } catch (err) { errorEl.className = "error"; errorEl.textContent = err.message; } } loadYears(); </script> </body> </html>
